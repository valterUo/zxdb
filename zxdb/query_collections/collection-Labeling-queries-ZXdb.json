{
  "version": 1,
  "type": "collection",
  "title": "Labeling queries - ZXdb",
  "items": [
    {
      "title": "Hadamard cancellation labeling query",
      "description": "",
      "query": {
        "code": {
          "value": "MATCH path = (start)-[:Wire*2..6]-(end)\r\nWHERE \r\n  // Even length path\r\n  size(relationships(path)) % 2 = 0\r\n  // All edges are unmarked Hadamard edges\r\n  AND ALL(edge IN relationships(path) WHERE edge.t = 2 AND edge.pattern_id IS NULL)\r\n  // All intermediate nodes are unmarked identity Z-spiders\r\n  AND ALL(node IN nodes(path)[1..-1] \r\n          WHERE node.t = 1 \r\n          AND node.phase % 2 = 0 \r\n          AND degree(node) = 2 \r\n          AND node.pattern_id IS NULL)\r\n  // Only process unmarked start/end nodes\r\n  AND start.pattern_id IS NULL \r\n  AND end.pattern_id IS NULL\r\n\r\n// Order by path length (longest first) and node IDs for consistency\r\nWITH path, nodes(path) as path_nodes, relationships(path) as path_edges\r\nORDER BY length(path) DESC, id(nodes(path)[0]), id(nodes(path)[-1])\r\nLIMIT 1\r\n\r\n// Mark this pattern with unique ID\r\nWITH path_nodes, path_edges, randomUUID() as pattern_id\r\n\r\n// Mark all edges in the path\r\nUNWIND path_edges AS edge\r\nSET edge.pattern_id = pattern_id\r\n\r\n// Mark all intermediate nodes in the path\r\nWITH path_nodes[1..-1] as intermediate_nodes, pattern_id, path_edges\r\nUNWIND intermediate_nodes AS node\r\nSET node.pattern_id = pattern_id\r\n\r\nRETURN DISTINCT pattern_id, length(path_edges) as path_length"
        },
        "params": {}
      },
      "style": {
        "code": {
          "value": "// A palette of colors used to color distinct node labels\nDefine(COLOR_PALETTE, AsArray(\n  #DD2222, #FB6E00, #FFC500, #720096,\n  #5E4FA2, #3288BD, #66C2A5, #ABDDA4,\n  #E6F598, #FEE08B, #D53E4F, #9E0142\n))\nDefine(COLOR_PALETTE_ITER, AsIterator(COLOR_PALETTE))\n\n// If there are no palette colors to use, use random colors instead\nDefine(RandomColor, Function(RGB(RandomInt(255), RandomInt(255), RandomInt(255))))\nDefine(GetNextColor, Function(\n  Coalesce(Next(COLOR_PALETTE_ITER), RandomColor())\n))\n\n// Cache map to keep a selected color for each node label\nDefine(ColorByLabel, AsMap())\nDefine(GetColorByLabel, Function(labels, Coalesce(\n  Get(ColorByLabel, labels),\n  Set(ColorByLabel, labels, GetNextColor())\n)))\nDefine(JoinLabels, Function(labels, Join(Sort(labels), \":\")))\n\n// Baseline node style that will be applied to every single node\n@NodeStyle {\n  Define(COLOR, GetColorByLabel(JoinLabels(Labels(node))))\n\n  size: 6\n  color: COLOR\n  color-hover: Lighter(COLOR)\n  color-selected: Darker(COLOR)\n  border-width: 0.6\n  border-color: #1D1D1D\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Overwrite node text with the node label if defined\n@NodeStyle Greater(Size(Labels(node)), 0) {\n  label: Format(\":{}\", Join(Labels(node), \" :\"))\n}\n\n// Overwrite node text with the property \"name\" if defined\n@NodeStyle HasProperty(node, \"name\") {\n  label: AsText(Property(node, \"name\"))\n}\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node label\n// @NodeStyle HasLabel(node, \"MyCustomLabel\") {\n//   color: black\n// }\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node property\n// @NodeStyle HasProperty(node, \"my_property_name\") {\n//   color: black\n//   label: AsText(Property(node, \"my_property_name\"))\n// }\n\nDefine(LATITUDE_FIELD, \"lat\")\nDefine(LONGITUDE_FIELD, \"lng\")\n\n// In the case of numeric latitude and longitude properties, set them up for a switch to a map view\n@NodeStyle And(IsNumber(Property(node, LATITUDE_FIELD)), IsNumber(Property(node, LONGITUDE_FIELD))) {\n  latitude: Property(node, LATITUDE_FIELD)\n  longitude: Property(node, LONGITUDE_FIELD)\n}\n\n// Baseline edge style that will be applied to every single edge\n@EdgeStyle {\n  color: #999999\n  color-hover: #1D1D1D\n  color-selected: #1D1D1D\n  width: 0.3\n  width-hover: 0.9\n  width-selected: 0.9\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Show edge text only if there is a small number of edges in the view\n@EdgeStyle Less(EdgeCount(graph), 30) {\n  label: Type(edge)\n}\n\n// In case of a map view, set the default tile layer\n@ViewStyle.Map {\n  tile-layer: \"light\"\n}\n\n// Canvas background color\n@ViewStyle {\n  background-color: #FFFFFF00\n}\n"
        },
        "title": "System Style"
      }
    },
    {
      "title": "Spider labeling query green",
      "description": "",
      "query": {
        "code": {
          "value": "// Label Z-wire patterns in order of decreasing length\r\nCALL {\r\n  // 4-edge paths first\r\n  MATCH path = (start)-[:Wire*4]-(end)\r\n  WHERE\r\n    ALL(edge IN relationships(path) WHERE edge.t = 1 AND edge.pattern_id IS NULL) AND\r\n    ALL(node IN nodes(path) WHERE node.t = 1 AND node.pattern_id IS NULL) AND\r\n    id(start) < id(end)\r\n  WITH DISTINCT path, start, end,\r\n       nodes(path) AS path_nodes,\r\n       relationships(path) AS path_edges\r\n  WHERE ALL(x IN path_nodes WHERE x.pattern_id IS NULL)\r\n    AND ALL(e IN path_edges WHERE e.pattern_id IS NULL)\r\n  WITH path_nodes, path_edges, randomUUID() AS pattern_id\r\n  FOREACH (edge IN path_edges | SET edge.pattern_id = pattern_id)\r\n  FOREACH (node IN path_nodes | SET node.pattern_id = pattern_id)\r\n  RETURN COUNT(DISTINCT pattern_id) AS labeled_4\r\n}\r\nCALL {\r\n  // Then 3-edge paths\r\n  MATCH path = (start)-[:Wire*3]-(end)\r\n  WHERE\r\n    ALL(edge IN relationships(path) WHERE edge.t = 1 AND edge.pattern_id IS NULL) AND\r\n    ALL(node IN nodes(path) WHERE node.t = 1 AND node.pattern_id IS NULL) AND\r\n    id(start) < id(end)\r\n  WITH DISTINCT path, start, end,\r\n       nodes(path) AS path_nodes,\r\n       relationships(path) AS path_edges\r\n  WHERE ALL(x IN path_nodes WHERE x.pattern_id IS NULL)\r\n    AND ALL(e IN path_edges WHERE e.pattern_id IS NULL)\r\n  WITH path_nodes, path_edges, randomUUID() AS pattern_id\r\n  FOREACH (edge IN path_edges | SET edge.pattern_id = pattern_id)\r\n  FOREACH (node IN path_nodes | SET node.pattern_id = pattern_id)\r\n  RETURN COUNT(DISTINCT pattern_id) AS labeled_3\r\n}\r\nCALL {\r\n  // Then 2-edge paths\r\n  MATCH path = (start)-[:Wire*2]-(end)\r\n  WHERE\r\n    ALL(edge IN relationships(path) WHERE edge.t = 1 AND edge.pattern_id IS NULL) AND\r\n    ALL(node IN nodes(path) WHERE node.t = 1 AND node.pattern_id IS NULL) AND\r\n    id(start) < id(end)\r\n  WITH DISTINCT path, start, end,\r\n       nodes(path) AS path_nodes,\r\n       relationships(path) AS path_edges\r\n  WHERE ALL(x IN path_nodes WHERE x.pattern_id IS NULL)\r\n    AND ALL(e IN path_edges WHERE e.pattern_id IS NULL)\r\n  WITH path_nodes, path_edges, randomUUID() AS pattern_id\r\n  FOREACH (edge IN path_edges | SET edge.pattern_id = pattern_id)\r\n  FOREACH (node IN path_nodes | SET node.pattern_id = pattern_id)\r\n  RETURN COUNT(DISTINCT pattern_id) AS labeled_2\r\n}\r\nCALL {\r\n  // Finally 1-edge paths\r\n  MATCH path = (start)-[:Wire*1]-(end)\r\n  WHERE\r\n    ALL(edge IN relationships(path) WHERE edge.t = 1 AND edge.pattern_id IS NULL) AND\r\n    ALL(node IN nodes(path) WHERE node.t = 1 AND node.pattern_id IS NULL) AND\r\n    id(start) < id(end)\r\n  WITH DISTINCT path, start, end,\r\n       nodes(path) AS path_nodes,\r\n       relationships(path) AS path_edges\r\n  WHERE ALL(x IN path_nodes WHERE x.pattern_id IS NULL)\r\n    AND ALL(e IN path_edges WHERE e.pattern_id IS NULL)\r\n  WITH path_nodes, path_edges, randomUUID() AS pattern_id\r\n  FOREACH (edge IN path_edges | SET edge.pattern_id = pattern_id)\r\n  FOREACH (node IN path_nodes | SET node.pattern_id = pattern_id)\r\n  RETURN COUNT(DISTINCT pattern_id) AS labeled_1\r\n}\r\nRETURN COALESCE(labeled_4, 0) + COALESCE(labeled_3, 0) +\r\n       COALESCE(labeled_2, 0) + COALESCE(labeled_1, 0)\r\n       AS patterns_labeled;\r\n"
        },
        "params": {}
      },
      "style": {
        "code": {
          "value": "// A palette of colors used to color distinct node labels\nDefine(COLOR_PALETTE, AsArray(\n  #DD2222, #FB6E00, #FFC500, #720096,\n  #5E4FA2, #3288BD, #66C2A5, #ABDDA4,\n  #E6F598, #FEE08B, #D53E4F, #9E0142\n))\nDefine(COLOR_PALETTE_ITER, AsIterator(COLOR_PALETTE))\n\n// If there are no palette colors to use, use random colors instead\nDefine(RandomColor, Function(RGB(RandomInt(255), RandomInt(255), RandomInt(255))))\nDefine(GetNextColor, Function(\n  Coalesce(Next(COLOR_PALETTE_ITER), RandomColor())\n))\n\n// Cache map to keep a selected color for each node label\nDefine(ColorByLabel, AsMap())\nDefine(GetColorByLabel, Function(labels, Coalesce(\n  Get(ColorByLabel, labels),\n  Set(ColorByLabel, labels, GetNextColor())\n)))\nDefine(JoinLabels, Function(labels, Join(Sort(labels), \":\")))\n\n// Baseline node style that will be applied to every single node\n@NodeStyle {\n  Define(COLOR, GetColorByLabel(JoinLabels(Labels(node))))\n\n  size: 6\n  color: COLOR\n  color-hover: Lighter(COLOR)\n  color-selected: Darker(COLOR)\n  border-width: 0.6\n  border-color: #1D1D1D\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Overwrite node text with the node label if defined\n@NodeStyle Greater(Size(Labels(node)), 0) {\n  label: Format(\":{}\", Join(Labels(node), \" :\"))\n}\n\n// Overwrite node text with the property \"name\" if defined\n@NodeStyle HasProperty(node, \"name\") {\n  label: AsText(Property(node, \"name\"))\n}\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node label\n// @NodeStyle HasLabel(node, \"MyCustomLabel\") {\n//   color: black\n// }\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node property\n// @NodeStyle HasProperty(node, \"my_property_name\") {\n//   color: black\n//   label: AsText(Property(node, \"my_property_name\"))\n// }\n\nDefine(LATITUDE_FIELD, \"lat\")\nDefine(LONGITUDE_FIELD, \"lng\")\n\n// In the case of numeric latitude and longitude properties, set them up for a switch to a map view\n@NodeStyle And(IsNumber(Property(node, LATITUDE_FIELD)), IsNumber(Property(node, LONGITUDE_FIELD))) {\n  latitude: Property(node, LATITUDE_FIELD)\n  longitude: Property(node, LONGITUDE_FIELD)\n}\n\n// Baseline edge style that will be applied to every single edge\n@EdgeStyle {\n  color: #999999\n  color-hover: #1D1D1D\n  color-selected: #1D1D1D\n  width: 0.3\n  width-hover: 0.9\n  width-selected: 0.9\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Show edge text only if there is a small number of edges in the view\n@EdgeStyle Less(EdgeCount(graph), 30) {\n  label: Type(edge)\n}\n\n// In case of a map view, set the default tile layer\n@ViewStyle.Map {\n  tile-layer: \"light\"\n}\n\n// Canvas background color\n@ViewStyle {\n  background-color: #FFFFFF00\n}\n"
        },
        "title": "System Style"
      }
    },
    {
      "title": "Spider labeling query red",
      "description": "",
      "query": {
        "code": {
          "value": "// Label X-wire patterns in order of decreasing length\r\nCALL {\r\n  // 4-edge paths first\r\n  MATCH path = (start)-[:Wire*4]-(end)\r\n  WHERE\r\n    ALL(edge IN relationships(path) WHERE edge.t = 1 AND edge.pattern_id IS NULL) AND\r\n    ALL(node IN nodes(path) WHERE node.t = 2 AND node.pattern_id IS NULL) AND\r\n    id(start) < id(end)\r\n  WITH DISTINCT path, start, end,\r\n       nodes(path) AS path_nodes,\r\n       relationships(path) AS path_edges\r\n  WHERE ALL(x IN path_nodes WHERE x.pattern_id IS NULL)\r\n    AND ALL(e IN path_edges WHERE e.pattern_id IS NULL)\r\n  WITH path_nodes, path_edges, randomUUID() AS pattern_id\r\n  FOREACH (edge IN path_edges | SET edge.pattern_id = pattern_id)\r\n  FOREACH (node IN path_nodes | SET node.pattern_id = pattern_id)\r\n  RETURN COUNT(DISTINCT pattern_id) AS labeled_4\r\n}\r\nCALL {\r\n  // Then 3-edge paths\r\n  MATCH path = (start)-[:Wire*3]-(end)\r\n  WHERE\r\n    ALL(edge IN relationships(path) WHERE edge.t = 1 AND edge.pattern_id IS NULL) AND\r\n    ALL(node IN nodes(path) WHERE node.t = 2 AND node.pattern_id IS NULL) AND\r\n    id(start) < id(end)\r\n  WITH DISTINCT path, start, end,\r\n       nodes(path) AS path_nodes,\r\n       relationships(path) AS path_edges\r\n  WHERE ALL(x IN path_nodes WHERE x.pattern_id IS NULL)\r\n    AND ALL(e IN path_edges WHERE e.pattern_id IS NULL)\r\n  WITH path_nodes, path_edges, randomUUID() AS pattern_id\r\n  FOREACH (edge IN path_edges | SET edge.pattern_id = pattern_id)\r\n  FOREACH (node IN path_nodes | SET node.pattern_id = pattern_id)\r\n  RETURN COUNT(DISTINCT pattern_id) AS labeled_3\r\n}\r\nCALL {\r\n  // Then 2-edge paths\r\n  MATCH path = (start)-[:Wire*2]-(end)\r\n  WHERE\r\n    ALL(edge IN relationships(path) WHERE edge.t = 1 AND edge.pattern_id IS NULL) AND\r\n    ALL(node IN nodes(path) WHERE node.t = 2 AND node.pattern_id IS NULL) AND\r\n    id(start) < id(end)\r\n  WITH DISTINCT path, start, end,\r\n       nodes(path) AS path_nodes,\r\n       relationships(path) AS path_edges\r\n  WHERE ALL(x IN path_nodes WHERE x.pattern_id IS NULL)\r\n    AND ALL(e IN path_edges WHERE e.pattern_id IS NULL)\r\n  WITH path_nodes, path_edges, randomUUID() AS pattern_id\r\n  FOREACH (edge IN path_edges | SET edge.pattern_id = pattern_id)\r\n  FOREACH (node IN path_nodes | SET node.pattern_id = pattern_id)\r\n  RETURN COUNT(DISTINCT pattern_id) AS labeled_2\r\n}\r\nCALL {\r\n  // Finally 1-edge paths\r\n  MATCH path = (start)-[:Wire*1]-(end)\r\n  WHERE\r\n    ALL(edge IN relationships(path) WHERE edge.t = 1 AND edge.pattern_id IS NULL) AND\r\n    ALL(node IN nodes(path) WHERE node.t = 2 AND node.pattern_id IS NULL) AND\r\n    id(start) < id(end)\r\n  WITH DISTINCT path, start, end,\r\n       nodes(path) AS path_nodes,\r\n       relationships(path) AS path_edges\r\n  WHERE ALL(x IN path_nodes WHERE x.pattern_id IS NULL)\r\n    AND ALL(e IN path_edges WHERE e.pattern_id IS NULL)\r\n  WITH path_nodes, path_edges, randomUUID() AS pattern_id\r\n  FOREACH (edge IN path_edges | SET edge.pattern_id = pattern_id)\r\n  FOREACH (node IN path_nodes | SET node.pattern_id = pattern_id)\r\n  RETURN COUNT(DISTINCT pattern_id) AS labeled_1\r\n}\r\nRETURN COALESCE(labeled_4, 0) + COALESCE(labeled_3, 0) +\r\n       COALESCE(labeled_2, 0) + COALESCE(labeled_1, 0)\r\n       AS patterns_labeled;\r\n"
        },
        "params": {}
      },
      "style": {
        "code": {
          "value": "// A palette of colors used to color distinct node labels\nDefine(COLOR_PALETTE, AsArray(\n  #DD2222, #FB6E00, #FFC500, #720096,\n  #5E4FA2, #3288BD, #66C2A5, #ABDDA4,\n  #E6F598, #FEE08B, #D53E4F, #9E0142\n))\nDefine(COLOR_PALETTE_ITER, AsIterator(COLOR_PALETTE))\n\n// If there are no palette colors to use, use random colors instead\nDefine(RandomColor, Function(RGB(RandomInt(255), RandomInt(255), RandomInt(255))))\nDefine(GetNextColor, Function(\n  Coalesce(Next(COLOR_PALETTE_ITER), RandomColor())\n))\n\n// Cache map to keep a selected color for each node label\nDefine(ColorByLabel, AsMap())\nDefine(GetColorByLabel, Function(labels, Coalesce(\n  Get(ColorByLabel, labels),\n  Set(ColorByLabel, labels, GetNextColor())\n)))\nDefine(JoinLabels, Function(labels, Join(Sort(labels), \":\")))\n\n// Baseline node style that will be applied to every single node\n@NodeStyle {\n  Define(COLOR, GetColorByLabel(JoinLabels(Labels(node))))\n\n  size: 6\n  color: COLOR\n  color-hover: Lighter(COLOR)\n  color-selected: Darker(COLOR)\n  border-width: 0.6\n  border-color: #1D1D1D\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Overwrite node text with the node label if defined\n@NodeStyle Greater(Size(Labels(node)), 0) {\n  label: Format(\":{}\", Join(Labels(node), \" :\"))\n}\n\n// Overwrite node text with the property \"name\" if defined\n@NodeStyle HasProperty(node, \"name\") {\n  label: AsText(Property(node, \"name\"))\n}\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node label\n// @NodeStyle HasLabel(node, \"MyCustomLabel\") {\n//   color: black\n// }\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node property\n// @NodeStyle HasProperty(node, \"my_property_name\") {\n//   color: black\n//   label: AsText(Property(node, \"my_property_name\"))\n// }\n\nDefine(LATITUDE_FIELD, \"lat\")\nDefine(LONGITUDE_FIELD, \"lng\")\n\n// In the case of numeric latitude and longitude properties, set them up for a switch to a map view\n@NodeStyle And(IsNumber(Property(node, LATITUDE_FIELD)), IsNumber(Property(node, LONGITUDE_FIELD))) {\n  latitude: Property(node, LATITUDE_FIELD)\n  longitude: Property(node, LONGITUDE_FIELD)\n}\n\n// Baseline edge style that will be applied to every single edge\n@EdgeStyle {\n  color: #999999\n  color-hover: #1D1D1D\n  color-selected: #1D1D1D\n  width: 0.3\n  width-hover: 0.9\n  width-selected: 0.9\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Show edge text only if there is a small number of edges in the view\n@EdgeStyle Less(EdgeCount(graph), 30) {\n  label: Type(edge)\n}\n\n// In case of a map view, set the default tile layer\n@ViewStyle.Map {\n  tile-layer: \"light\"\n}\n\n// Canvas background color\n@ViewStyle {\n  background-color: #FFFFFF00\n}\n"
        },
        "title": "System Style"
      }
    },
    {
      "title": "Spider labeling query green and red",
      "description": "",
      "query": {
        "code": {
          "value": "MATCH pathA = (sA:Node)-[:Wire*1..1]-(eA:Node)\r\nWHERE sA.pattern_id IS NULL AND eA.pattern_id IS NULL\r\n  AND ALL(r IN relationships(pathA) WHERE r.t = 2 AND r.pattern_id IS NULL)\r\n  AND ALL(n IN nodes(pathA) WHERE n.pattern_id IS NULL AND n.t IN [1,2])\r\n  // alternation: every edge connects different spider types\r\n  AND ALL(r IN relationships(pathA) WHERE startNode(r).t <> endNode(r).t)\r\nWITH pathA AS p, sA AS s, eA AS e, length(pathA) AS L\r\nORDER BY L DESC, id(s), id(e)\r\nLIMIT 1\r\n\r\nWITH nodes(p) AS path_nodes, relationships(p) AS path_edges, s, e, randomUUID() AS pattern_id\r\nSET s.start_node = true, e.end_node = true\r\nFOREACH (edge IN path_edges | SET edge.pattern_id = pattern_id)\r\nFOREACH (node IN path_nodes | SET node.pattern_id = pattern_id)\r\nRETURN pattern_id, size(path_edges) AS path_length"
        },
        "params": {}
      },
      "style": {
        "code": {
          "value": "// A palette of colors used to color distinct node labels\nDefine(COLOR_PALETTE, AsArray(\n  #DD2222, #FB6E00, #FFC500, #720096,\n  #5E4FA2, #3288BD, #66C2A5, #ABDDA4,\n  #E6F598, #FEE08B, #D53E4F, #9E0142\n))\nDefine(COLOR_PALETTE_ITER, AsIterator(COLOR_PALETTE))\n\n// If there are no palette colors to use, use random colors instead\nDefine(RandomColor, Function(RGB(RandomInt(255), RandomInt(255), RandomInt(255))))\nDefine(GetNextColor, Function(\n  Coalesce(Next(COLOR_PALETTE_ITER), RandomColor())\n))\n\n// Cache map to keep a selected color for each node label\nDefine(ColorByLabel, AsMap())\nDefine(GetColorByLabel, Function(labels, Coalesce(\n  Get(ColorByLabel, labels),\n  Set(ColorByLabel, labels, GetNextColor())\n)))\nDefine(JoinLabels, Function(labels, Join(Sort(labels), \":\")))\n\n// Baseline node style that will be applied to every single node\n@NodeStyle {\n  Define(COLOR, GetColorByLabel(JoinLabels(Labels(node))))\n\n  size: 6\n  color: COLOR\n  color-hover: Lighter(COLOR)\n  color-selected: Darker(COLOR)\n  border-width: 0.6\n  border-color: #1D1D1D\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Overwrite node text with the node label if defined\n@NodeStyle Greater(Size(Labels(node)), 0) {\n  label: Format(\":{}\", Join(Labels(node), \" :\"))\n}\n\n// Overwrite node text with the property \"name\" if defined\n@NodeStyle HasProperty(node, \"name\") {\n  label: AsText(Property(node, \"name\"))\n}\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node label\n// @NodeStyle HasLabel(node, \"MyCustomLabel\") {\n//   color: black\n// }\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node property\n// @NodeStyle HasProperty(node, \"my_property_name\") {\n//   color: black\n//   label: AsText(Property(node, \"my_property_name\"))\n// }\n\nDefine(LATITUDE_FIELD, \"lat\")\nDefine(LONGITUDE_FIELD, \"lng\")\n\n// In the case of numeric latitude and longitude properties, set them up for a switch to a map view\n@NodeStyle And(IsNumber(Property(node, LATITUDE_FIELD)), IsNumber(Property(node, LONGITUDE_FIELD))) {\n  latitude: Property(node, LATITUDE_FIELD)\n  longitude: Property(node, LONGITUDE_FIELD)\n}\n\n// Baseline edge style that will be applied to every single edge\n@EdgeStyle {\n  color: #999999\n  color-hover: #1D1D1D\n  color-selected: #1D1D1D\n  width: 0.3\n  width-hover: 0.9\n  width-selected: 0.9\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Show edge text only if there is a small number of edges in the view\n@EdgeStyle Less(EdgeCount(graph), 30) {\n  label: Type(edge)\n}\n\n// In case of a map view, set the default tile layer\n@ViewStyle.Map {\n  tile-layer: \"light\"\n}\n\n// Canvas background color\n@ViewStyle {\n  background-color: #FFFFFF00\n}\n"
        },
        "title": "System Style"
      }
    },
    {
      "title": "Local complement labeling",
      "description": "",
      "query": {
        "code": {
          "value": "// 1) Candidates: green spiders (t=1), phase Â±0.5, unlabeled, no boundary neighbors\r\nMATCH (s)\r\nWHERE s.t = 1\r\n  AND (s.phase = 0.5 OR s.phase = -0.5)\r\n  AND s.pattern_id IS NULL\r\nOPTIONAL MATCH (s)-[:Wire]-(b)\r\nWHERE b.t = 0\r\nWITH s, COUNT(b) AS bcnt\r\nWHERE bcnt = 0\r\n\r\n// 2) Pick exactly one spider deterministically (smallest id)\r\nWITH MIN(id(s)) AS chosen_id\r\nMATCH (spider) WHERE id(spider) = chosen_id\r\n\r\n// 3) Ensure all neighbors are unlabeled\r\nMATCH (spider)-[:Wire]-(nbr)\r\nWITH spider,\r\n     COLLECT(nbr) AS neighbors,\r\n     COUNT(nbr) AS total_neighbors,\r\n     SUM(CASE WHEN nbr.pattern_id IS NULL THEN 1 ELSE 0 END) AS unlabeled_neighbors\r\nWHERE total_neighbors = unlabeled_neighbors\r\n\r\n// 4) Use a deterministic pattern id (same for all nodes in the pattern)\r\nWITH [spider] + neighbors AS all_nodes, randomUUID() AS pattern_id\r\n\r\n// 5) Label all nodes with the same id in one pass\r\nFOREACH (n IN all_nodes | SET n.pattern_id = pattern_id)\r\n\r\nWITH COUNT(DISTINCT pattern_id) AS num_processed\r\nRETURN CASE WHEN num_processed > 0 THEN 1 ELSE 0 END AS changed"
        },
        "params": {}
      },
      "style": {
        "code": {
          "value": "// A palette of colors used to color distinct node labels\nDefine(COLOR_PALETTE, AsArray(\n  #DD2222, #FB6E00, #FFC500, #720096,\n  #5E4FA2, #3288BD, #66C2A5, #ABDDA4,\n  #E6F598, #FEE08B, #D53E4F, #9E0142\n))\nDefine(COLOR_PALETTE_ITER, AsIterator(COLOR_PALETTE))\n\n// If there are no palette colors to use, use random colors instead\nDefine(RandomColor, Function(RGB(RandomInt(255), RandomInt(255), RandomInt(255))))\nDefine(GetNextColor, Function(\n  Coalesce(Next(COLOR_PALETTE_ITER), RandomColor())\n))\n\n// Cache map to keep a selected color for each node label\nDefine(ColorByLabel, AsMap())\nDefine(GetColorByLabel, Function(labels, Coalesce(\n  Get(ColorByLabel, labels),\n  Set(ColorByLabel, labels, GetNextColor())\n)))\nDefine(JoinLabels, Function(labels, Join(Sort(labels), \":\")))\n\n// Baseline node style that will be applied to every single node\n@NodeStyle {\n  Define(COLOR, GetColorByLabel(JoinLabels(Labels(node))))\n\n  size: 6\n  color: COLOR\n  color-hover: Lighter(COLOR)\n  color-selected: Darker(COLOR)\n  border-width: 0.6\n  border-color: #1D1D1D\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Overwrite node text with the node label if defined\n@NodeStyle Greater(Size(Labels(node)), 0) {\n  label: Format(\":{}\", Join(Labels(node), \" :\"))\n}\n\n// Overwrite node text with the property \"name\" if defined\n@NodeStyle HasProperty(node, \"name\") {\n  label: AsText(Property(node, \"name\"))\n}\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node label\n// @NodeStyle HasLabel(node, \"MyCustomLabel\") {\n//   color: black\n// }\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node property\n// @NodeStyle HasProperty(node, \"my_property_name\") {\n//   color: black\n//   label: AsText(Property(node, \"my_property_name\"))\n// }\n\nDefine(LATITUDE_FIELD, \"lat\")\nDefine(LONGITUDE_FIELD, \"lng\")\n\n// In the case of numeric latitude and longitude properties, set them up for a switch to a map view\n@NodeStyle And(IsNumber(Property(node, LATITUDE_FIELD)), IsNumber(Property(node, LONGITUDE_FIELD))) {\n  latitude: Property(node, LATITUDE_FIELD)\n  longitude: Property(node, LONGITUDE_FIELD)\n}\n\n// Baseline edge style that will be applied to every single edge\n@EdgeStyle {\n  color: #999999\n  color-hover: #1D1D1D\n  color-selected: #1D1D1D\n  width: 0.3\n  width-hover: 0.9\n  width-selected: 0.9\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Show edge text only if there is a small number of edges in the view\n@EdgeStyle Less(EdgeCount(graph), 30) {\n  label: Type(edge)\n}\n\n// In case of a map view, set the default tile layer\n@ViewStyle.Map {\n  tile-layer: \"light\"\n}\n\n// Canvas background color\n@ViewStyle {\n  background-color: #FFFFFF00\n}\n"
        },
        "title": "System Style"
      }
    },
    {
      "title": "Bialgebra labeling",
      "description": "",
      "query": {
        "code": {
          "value": "// Find inclusion-wise maximal bipartite cliques where t=1 and t=2\r\nMATCH (seed)\r\nWHERE seed.t = 1\r\n// Collect all neighbors in the opposite partition\r\nOPTIONAL MATCH (seed)-[r]-(b)\r\nWHERE b.t = 2 AND r.t = 1\r\nWITH seed, collect(DISTINCT b) AS B\r\nWHERE size(B) > 0\r\n\r\n// Find all t=1 nodes connected to ALL nodes in B\r\nMATCH (x)\r\nWHERE x.t = 1\r\nOPTIONAL MATCH (x)-[r]-(b2)\r\nWHERE b2 IN B AND r.t = 1\r\nWITH B, x, count(DISTINCT b2) AS cnt_connected\r\nWHERE cnt_connected = size(B)\r\n\r\n// Collect closure\r\nWITH B, collect(DISTINCT x) AS A\r\nWHERE size(B) + size(A) > 2\r\n\r\n// Assign a shared random pattern_id to all nodes in A and B\r\nCALL {\r\n  WITH A, B\r\n  WITH A + B AS allNodes, randomUUID() AS pattern_id\r\n  UNWIND allNodes AS n\r\n  SET n.pattern_id = pattern_id\r\n  RETURN pattern_id\r\n  LIMIT 1\r\n}\r\n\r\nRETURN A, B, size(B) + size(A) AS area, pattern_id\r\nORDER BY area DESC;"
        },
        "params": {}
      },
      "style": {
        "code": {
          "value": "// A palette of colors used to color distinct node labels\nDefine(COLOR_PALETTE, AsArray(\n  #DD2222, #FB6E00, #FFC500, #720096,\n  #5E4FA2, #3288BD, #66C2A5, #ABDDA4,\n  #E6F598, #FEE08B, #D53E4F, #9E0142\n))\nDefine(COLOR_PALETTE_ITER, AsIterator(COLOR_PALETTE))\n\n// If there are no palette colors to use, use random colors instead\nDefine(RandomColor, Function(RGB(RandomInt(255), RandomInt(255), RandomInt(255))))\nDefine(GetNextColor, Function(\n  Coalesce(Next(COLOR_PALETTE_ITER), RandomColor())\n))\n\n// Cache map to keep a selected color for each node label\nDefine(ColorByLabel, AsMap())\nDefine(GetColorByLabel, Function(labels, Coalesce(\n  Get(ColorByLabel, labels),\n  Set(ColorByLabel, labels, GetNextColor())\n)))\nDefine(JoinLabels, Function(labels, Join(Sort(labels), \":\")))\n\n// Baseline node style that will be applied to every single node\n@NodeStyle {\n  Define(COLOR, GetColorByLabel(JoinLabels(Labels(node))))\n\n  size: 6\n  color: COLOR\n  color-hover: Lighter(COLOR)\n  color-selected: Darker(COLOR)\n  border-width: 0.6\n  border-color: #1D1D1D\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Overwrite node text with the node label if defined\n@NodeStyle Greater(Size(Labels(node)), 0) {\n  label: Format(\":{}\", Join(Labels(node), \" :\"))\n}\n\n// Overwrite node text with the property \"name\" if defined\n@NodeStyle HasProperty(node, \"name\") {\n  label: AsText(Property(node, \"name\"))\n}\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node label\n// @NodeStyle HasLabel(node, \"MyCustomLabel\") {\n//   color: black\n// }\n\n// Feel free to uncomment the lines below to set up a custom style for the specific node property\n// @NodeStyle HasProperty(node, \"my_property_name\") {\n//   color: black\n//   label: AsText(Property(node, \"my_property_name\"))\n// }\n\nDefine(LATITUDE_FIELD, \"lat\")\nDefine(LONGITUDE_FIELD, \"lng\")\n\n// In the case of numeric latitude and longitude properties, set them up for a switch to a map view\n@NodeStyle And(IsNumber(Property(node, LATITUDE_FIELD)), IsNumber(Property(node, LONGITUDE_FIELD))) {\n  latitude: Property(node, LATITUDE_FIELD)\n  longitude: Property(node, LONGITUDE_FIELD)\n}\n\n// Baseline edge style that will be applied to every single edge\n@EdgeStyle {\n  color: #999999\n  color-hover: #1D1D1D\n  color-selected: #1D1D1D\n  width: 0.3\n  width-hover: 0.9\n  width-selected: 0.9\n  font-size: 3\n  font-color: #1D1D1D\n}\n\n// Show edge text only if there is a small number of edges in the view\n@EdgeStyle Less(EdgeCount(graph), 30) {\n  label: Type(edge)\n}\n\n// In case of a map view, set the default tile layer\n@ViewStyle.Map {\n  tile-layer: \"light\"\n}\n\n// Canvas background color\n@ViewStyle {\n  background-color: #FFFFFF00\n}\n"
        },
        "title": "System Style"
      }
    }
  ]
}